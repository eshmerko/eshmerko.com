{% extends 'base.html' %}
{% csrf_token %}
{% block title %}Главная - eshmerko.com{% endblock %}

{% block content %}
<div class="hero-section">
    <div class="hero-content">
        <h1 class="main-title">
            <span class="highlight">ESHMERKO.COM</span>
            <div class="subtitle">
                <span class="typing-text">Разработка на Python</span>
                <span class="cursor"></span>
            </div>
        </h1>
        
        <div class="intro-text">
            <p>Предлагаю профессиональные услуги по разработке <span class="highlight-text">телеграм ботов</span>, <span class="highlight-text">парсеров данных</span> и <span class="highlight-text">программного обеспечения</span> на Python.</p>
            <p class="tagline">Помогу вам автоматизировать бизнес-процессы и решить ваши задачи <span class="code-element">{<span class="code-text">быстро</span>, <span class="code-text">качественно</span>, <span class="code-text">надежно</span>}</span></p>
        </div>
        
        <div class="tech-icons">
            <div class="tech-icon"><i class="fab fa-python"></i> Python</div>
            <div class="tech-icon"><i class="fab fa-telegram"></i> Telegram</div>
            <div class="tech-icon"><i class="fas fa-code"></i> API</div>
            <div class="tech-icon"><i class="fas fa-database"></i> Data</div>
            <div class="tech-icon"><i class="django-icon"></i>Django</div>
        </div>
    </div>
</div>

<section id="services">
    <h2>Услуги</h2>

    <div class="service-card">
        <span class="pulse-dot"></span>
        <span class="pulse-dot"></span>
        <div class="service-content">
            <div class="service-info">
                <h3 class="service-title">Разработка Телеграм Ботов</h3>
                <p class="service-description">Создаю телеграм ботов любой сложности: от простых информационных ботов до сложных ботов для автоматизации бизнес-процессов, приема заказов, уведомлений и интеграции с другими системами.</p>
                <a class="btn btn-primary" href="#contact">Заказать бота</a>
            </div>
            <div class="price-tag">
                <div class="price-content">
                    <span class="price-from">от</span>
                    <span class="price-value">$50</span>
                </div>
            </div>
        </div>
    </div>

    <div class="service-card">
        <span class="pulse-dot"></span>
        <span class="pulse-dot"></span>
        <div class="service-content">
            <div class="service-info">
                <h3 class="service-title">Парсинг Данных</h3>
                <p class="service-description">Разрабатываю парсеры данных для извлечения информации из веб-сайтов. Собираю данные для анализа, мониторинга цен, отслеживания конкурентов и других задач.</p>
                <a class="btn btn-primary" href="#contact">Заказать парсер</a>
            </div>
            <div class="price-tag">
                <div class="price-content">
                    <span class="price-from">от</span>
                    <span class="price-value">$50</span>
                </div>
            </div>
        </div>
    </div>

    <div class="service-card">
        <span class="pulse-dot"></span>
        <span class="pulse-dot"></span>
        <div class="service-content">
            <div class="service-info">
                <h3 class="service-title">Разработка ПО</h3>
                <p class="service-description">Разрабатываю программное обеспечение на Python для решения различных задач. Создаю десктопные приложения, веб-сервисы, автоматизированные системы и другие решения.</p>
                <a class="btn btn-primary" href="#contact">Заказать ПО</a>
            </div>
            <div class="price-tag">
                <div class="price-content">
                    <span class="price-from">от</span>
                    <span class="price-value">$300</span>
                </div>
            </div>
        </div>
    </div>

    <div class="service-card">
        <span class="pulse-dot"></span>
        <span class="pulse-dot"></span>
        <div class="service-content">
            <div class="service-info">
                <h3 class="service-title">Разработка сайтов на Django</h3>
                <p class="service-description">Создаю мощные и безопасные веб-приложения любой сложности на Django. От интернет-магазинов и корпоративных порталов до сложных SaaS-решений. Гарантирую чистую архитектуру, масштабируемость и интеграцию с платежными системами, CRM и аналитическими сервисами. Оптимизированная производительность и защита данных - ключевые преимущества моих решений.</p>
                <a class="btn btn-primary" href="#contact">Заказать сайт</a>
            </div>
            <div class="price-tag">
                <div class="price-content">
                    <span class="price-from">от</span>
                    <span class="price-value">$500</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Модальное окно -->
<div class="modal-overlay" id="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <h3>Оформление заказа</h3>
        <form id="orderForm">
            <input type="hidden" id="serviceType" name="service_type">
            <div class="form-group">
                <input type="text" id="name" name="name" placeholder="Ваше имя" required>
            </div>
            <div class="form-group">
                <input type="tel" id="phone" name="phone" placeholder="Ваш телефон" required>
            </div>
            <div class="form-group">
                <textarea id="message" name="message" placeholder="Дополнительные детали"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Отправить заявку</button>
        </form>
    </div>
</div>


<!-- Подключение Font Awesome для иконок -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Анимация текста
        const text = "Разработка на Python";
        const typingElement = document.querySelector('.typing-text');
        const cursor = document.querySelector('.cursor');
        typingElement.textContent = "";
        let i = 0;
        const typingInterval = setInterval(() => {
            if (i < text.length) {
                typingElement.textContent += text.charAt(i);
                i++;
            } else {
                clearInterval(typingInterval);
            }
        }, 100);
    });

    // Модальное окно
    function openModal(serviceType) {
        const modal = document.getElementById('modal');
        const serviceTypeInput = document.getElementById('serviceType');
        serviceTypeInput.value = serviceType;
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }

    function closeModal() {
        const modal = document.getElementById('modal');
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }

    document.querySelectorAll('[href="#contact"]').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.preventDefault();
            const serviceName = btn.closest('.service-info').querySelector('.service-title').textContent;
            document.getElementById('serviceType').value = serviceName;
            document.getElementById('modal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        });
    });

    document.querySelector('.close-btn').addEventListener('click', closeModal);

    window.addEventListener('click', function(event) {
        const modal = document.getElementById('modal');
        if (event.target === modal) {
            closeModal();
        }
    });

    // Отправка формы через Django backend
    document.getElementById('orderForm').addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = {
            service: document.getElementById('serviceType').value,
            name: document.getElementById('name').value,
            phone: document.getElementById('phone').value,
            message: document.getElementById('message').value
        };

        try {
            const response = await fetch('/send-order/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: JSON.stringify(formData)
            });

            if (response.ok) {
                alert('Заявка успешно отправлена!');
                closeModal();
                document.getElementById('orderForm').reset();
            } else {
                alert('Ошибка отправки. Попробуйте позже.');
            }
        } catch (error) {
            alert('Ошибка сети. Попробуйте ещё раз.');
        }
    });

    // Получение CSRF-токена
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.startsWith(name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>

{% endblock %}